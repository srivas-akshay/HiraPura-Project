{% extends "base.html" %}
{% load static %}

{% block title %}Pre Event Feedback{% endblock %}

{% block content %}
<div class="glass-card">
    <h1>HIRAPURA</h1>
    <p>હિરાપુરા ગામના સ્વાગત સમ્મેલનમાં આવવા માટે કૃપા કરીને ફોન નંબરથી લોગિન કરો.</p>
    <p>To attend the welcome gathering in Hirapura village, please log in with your phone number.</p>

    {% if not show_otp %}
    <form method="post" autocomplete="off">
      {% csrf_token %}
      <input type="hidden" name="action" value="send_otp">
      <div class="form-field">{{ form.phone }}</div>
      <button type="submit" class="btn-glass">Send OTP</button>
    </form>
    {% endif %}

    {% if show_otp %}
    <form method="post" autocomplete="off">
      {% csrf_token %}
      <input type="hidden" name="action" value="verify_otp">
      <div class="form-field">
        <input type="text" name="phone" value="{{ phone }}" readonly>
      </div>
      <div class="form-field">
        <input type="text" name="otp" placeholder="Enter OTP received on your phone" required autofocus>
      </div>
      <button type="submit" class="btn-glass">Verify & Login</button>
    </form>

    <form method="post" style="margin-top:12px;">
      {% csrf_token %}
      <input type="hidden" name="action" value="send_otp">
      <input type="hidden" name="phone" value="{{ phone }}">
      <button type="submit" class="btn-glass">Resend OTP</button>
    </form>
    {% endif %}

    {% if messages %}
      {% for message in messages %}
        <div class="messages {{ message.tags }}">{{ message|linebreaksbr }}</div>
      {% endfor %}
    {% endif %}
</div>
{% endblock %}
